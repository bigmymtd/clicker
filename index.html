<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>megane-clicker</title>
</head>
<body>
<div id="app"></div>
<!-- built files will be auto injected -->

<script>
  class Option {
    constructor(optionName, price, upSpeed, priceIncreaseRate) {
      this._optionName = optionName; //オプション名
      this._price = price; //初期値
      this._upSpeed = upSpeed; //増やせる速度
      this._priceIncreaseRate = priceIncreaseRate; //値上がり率
    }
    get optionName() {
      return this._optionName;
    }
    get price() {
      return this._price;
    }
    get upSpeed() {
      return this._upSpeed;
    }
    get priceIncreaseRate() {
      return this._priceIncreaseRate;
    }
  }
  class OptionPrice {
    constructor(optionA, optionB) {
      this._optionA = optionA;
      this._optionB = optionB;
    }

    get optionA() {
      return this._optionA;
    }

    get optionB() {
      return this._optionB;
    }

    purchaseOptionA() {
      this._optionA._price = parseInt(this._optionA._price * this._optionA._priceIncreaseRate);
    }

    purchaseOptionB() {
      this._optionB._price = parseInt(this._optionB._price * this._optionB._priceIncreaseRate);
    }
  }

  class PurchasedOptions {
    constructor(optionA, optionACount, optionB, optionBCount) {
      this._optionA = optionA;
      this._optionACount = optionACount;
      this._optionB = optionB;
      this._optionBCount = optionBCount;
    }

    get optionA() {
      return this._optionA;
    }

    get optionB() {
      return this._optionB;
    }

    /**
     *
     * @return {number}
     */
    get addValue() {
      return (this._optionACount * this._optionA._upSpeed) + (this._optionBCount * this._optionB._upSpeed)
    }

    purchaseOptionA() {
      this._optionACount += 1;
    }

    purchaseOptionB() {
      this._optionBCount += 1;
    }
  }

  class Employee {
    constructor(value) {
      this._value = value;
    }

    get value() {
      return this._value;
    }

    increase(value) {
      this._value += value;
    }
  }

  class Employees {
    constructor(value) {
      this._value = value;
    }

    get value() {
      return this._value;
    }

    increase(value) {
      this._value += value;
    }

    decrease(value) {
      this._value -= value;
    }
  }

  /**
   * 社員管理
   */
  class EmployeesFactory {
    constructor(employees, employee, purchasedOptions) {
      this._employees = employees;
      this._employee = employee;
      this._purchasedOptions = purchasedOptions;
    }

    click() {
      this._employees.increase(1)
    }

    increase1Second() {
      this._employees.increase(this._employee.value + this._purchasedOptions.addValue);
    }

    get view() {
      return this._employees.value;
    }
  }

  class OptionOperator {
    constructor(employees, optionPrice, purchasedOptions) {
      this._employees = employees;
      this._optionPrice = optionPrice;
      this._purchasedOptions = purchasedOptions;
    }

    get optionAPrice() {
      return this._optionPrice._optionA._price;
    }

    get optionBPrice() {
      return this._optionPrice._optionB._price;
    }

    get optionAName() {
      return this._optionPrice._optionA._optionName;
    }

    get optionBName() {
      return this._optionPrice._optionB._optionName;
    }

    get optionACount() {
      return this._purchasedOptions._optionACount;
    }

    get optionBCount() {
      return this._purchasedOptions._optionBCount;
    }

    purchaseOptionA() {
      if(this._employees.value > this._optionPrice.optionA._price) {
        this._employees.decrease(this._optionPrice.optionA._price);
        this._optionPrice.purchaseOptionA();
        this._purchasedOptions.purchaseOptionA();
      }
    }

    purchaseOptionB() {
      if(this._employees.value > this._optionPrice.optionB._price) {
        this._employees.decrease(this._optionPrice.optionB._price);
        this._optionPrice.purchaseOptionB();
        this._purchasedOptions.purchaseOptionB();
      }
    }
  }

  var optionPrice = new OptionPrice(new Option("完全週休2日制", 15, 100, 1.1), new Option("家賃補助", 20, 150, 1.2));
  var purchasedOptions = new PurchasedOptions(new Option("完全週休2日制", 15, 100, 1.1), 0, new Option("家賃補助", 20, 150, 1.2), 0);
  var emp = new Employees(0);
  var emp2 = new Employee(1);
  var employeesFactory = new EmployeesFactory(emp, emp2, purchasedOptions);
  var optionOperator = new OptionOperator(emp, optionPrice, purchasedOptions);

  setInterval(() => {
    employeesFactory.increase1Second()
  }, 100);
</script>

</body>
</html>
